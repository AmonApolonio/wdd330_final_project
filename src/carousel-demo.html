<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carousel Demo</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/carousel.css">
  <style>
    body {
      padding: 20px;
    }
    .demo-container {
      max-width: 1200px;
      margin: 0 auto;
    }
    h1 {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <div class="demo-container">
    <h1>Carousel Component Demo</h1>
    <div id="carousel-demo"></div>
  </div>  <script type="module">
    import Carousel from './js/ui/components/Carousel.js';
    import { getTrendingAnime, getTopAiringAnime, getUpcomingAnime } from './js/api/jikan.js';

    // Create containers for different carousel types
    function createDemoStructure() {
      const mainContainer = document.getElementById('carousel-demo');
      
      // Clear any existing content
      mainContainer.innerHTML = '';
      
      // Create sections for different carousel types
      const sections = [
        { id: 'trending-demo', title: 'Trending Anime' },
        { id: 'airing-demo', title: 'Top Airing Anime' },
        { id: 'upcoming-demo', title: 'Upcoming Anime' }
      ];
      
      sections.forEach(section => {
        const sectionEl = document.createElement('div');
        sectionEl.className = 'carousel-demo-section';
        sectionEl.innerHTML = `
          <h2>${section.title}</h2>
          <div id="${section.id}" class="carousel-container">
            <p>Loading ${section.title.toLowerCase()}...</p>
          </div>
        `;
        mainContainer.appendChild(sectionEl);
      });
      
      // Add some styling for the demo
      const style = document.createElement('style');
      style.textContent = `
        .carousel-demo-section {
          margin-bottom: 40px;
        }
        .carousel-demo-section h2 {
          margin-bottom: 15px;
        }
      `;
      document.head.appendChild(style);
    }
    
    // Initialize a specific carousel
    async function initSpecificCarousel(containerId, fetchFunction, title) {
      const container = document.getElementById(containerId);
      if (!container) return;
      
      try {
        const response = await fetchFunction(8);
        
        if (response && response.data && response.data.length > 0) {
          container.innerHTML = '';
          Carousel(container, response.data);
          console.log(`${title} carousel initialized with ${response.data.length} items`);
        } else {
          container.innerHTML = `<p>No ${title.toLowerCase()} data found.</p>`;
        }
      } catch (error) {
        console.error(`Error loading ${title.toLowerCase()} data:`, error);
        container.innerHTML = `
          <div class="error-message">
            <p>Failed to load ${title.toLowerCase()} data.</p>
            <button id="retry-${containerId}" class="retry-btn">Retry</button>
          </div>
        `;
        
        document.getElementById(`retry-${containerId}`)?.addEventListener('click', () => {
          initSpecificCarousel(containerId, fetchFunction, title);
        });
      }
    }
    
    // Initialize all carousels
    async function initAllCarousels() {
      // First set up the structure
      createDemoStructure();
      
      // Initialize each carousel in parallel for better performance
      await Promise.allSettled([
        initSpecificCarousel('trending-demo', getTrendingAnime, 'Trending'),
        initSpecificCarousel('airing-demo', getTopAiringAnime, 'Top Airing'),
        initSpecificCarousel('upcoming-demo', getUpcomingAnime, 'Upcoming')
      ]);
    }
    
    // Start initializing the carousels
    initAllCarousels();
  </script>
</body>
</html>
